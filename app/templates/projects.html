{% extends "base.html" %} {% block content %}
<section class="py-20">
    <div class="max-w-6xl mx-auto px-6">
        <h1 class="text-4xl font-bold mb-4 gradient-text">Projects</h1>
        <p class="text-text-secondary mb-12">
            My open source projects and dotfiles configurations.
        </p>

        <div
            id="projects-list"
            class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"
            hx-get="/api/github/repos"
            hx-trigger="load"
            hx-swap="innerHTML"
        >
            <div class="col-span-full text-center py-12 text-text-muted">
                Loading projects...
            </div>
        </div>
    </div>
</section>
{% endblock %} {% block scripts %}
<script>
    function escapeHtml(text) {
        if (!text) return "";
        const div = document.createElement("div");
        div.textContent = text;
        return div.innerHTML;
    }

    document.body.addEventListener("htmx:afterSwap", function (evt) {
        if (evt.detail.target.id === "projects-list") {
            const repos = JSON.parse(evt.detail.xhr.responseText);
            let html = "";
            repos.slice(0, 9).forEach((repo) => {
                const name = escapeHtml(repo.name);
                const description =
                    escapeHtml(repo.description) || "No description";
                const language = escapeHtml(repo.language);
                const url = encodeURI(repo.html_url);
                const stars = parseInt(repo.stargazers_count, 10) || 0;

                html += `
                <a href="${url}" target="_blank" rel="noopener noreferrer"
                   class="bg-dark-700 rounded-xl p-6 border border-dark-600 hover:border-accent-blue hover:bg-dark-600 transition-all duration-300 block group">
                    <h3 class="text-xl font-semibold mb-2 text-text-primary group-hover:text-accent-blue transition">${name}</h3>
                    <p class="text-text-secondary text-sm mb-4">${description}</p>
                    <div class="flex items-center gap-4 text-sm text-text-muted">
                        ${language ? `<span>${language}</span>` : ""}
                        <span>${stars} stars</span>
                    </div>
                </a>
            `;
            });
            evt.detail.target.innerHTML = html;
        }
    });
</script>
{% endblock %}
