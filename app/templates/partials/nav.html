<nav
    x-data="{
        lastScroll: 0,
        scrolled: false,
        currentMode: window.themeState?.mode || 'dark',
        currentPalette: window.themeState?.palette || 'tokyo',
        handleScroll() {
            const currentScroll = window.scrollY;
            this.scrolled = currentScroll > 100;
            this.lastScroll = currentScroll;
        },
        init() {
            window.addEventListener('themechange', (e) => {
                this.currentMode = e.detail.mode;
                this.currentPalette = e.detail.palette;
            });
        }
    }"
    @scroll.window="handleScroll()"
    class="fixed top-0 w-full z-50"
>
    <!-- Full width nav (default state) -->
    <div
        :class="scrolled ? '-translate-y-full' : 'translate-y-0'"
        class="transition-transform duration-500 ease-out bg-dark-800/80 backdrop-blur-md border-b border-dark-600"
    >
        <div
            class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center"
        >
            <a href="/#home" class="text-xl font-bold gradient-text">Duma</a>
            <div class="flex items-center gap-6 text-sm text-text-secondary">
                <a href="/#home" class="hover:text-accent-blue transition"
                    >Home</a
                >
                <a href="/#about" class="hover:text-accent-blue transition"
                    >About</a
                >
                <a href="/#projects" class="hover:text-accent-blue transition"
                    >Projects</a
                >
                <a href="/gallery" class="hover:text-accent-blue transition"
                    >Gallery</a
                >

                <!-- Theme Controls -->
                <div class="flex items-center gap-2">
                    <!-- Dark/Light Mode Toggle -->
                    <button
                        @click="toggleMode()"
                        class="flex items-center justify-center w-9 h-9 rounded-lg bg-dark-700/50 border border-dark-600 hover:border-accent-blue transition"
                        :title="currentMode === 'dark' ? 'Switch to light mode' : 'Switch to dark mode'"
                    >
                        <!-- Sun icon (shown in dark mode - click to go light) -->
                        <svg
                            x-show="currentMode === 'dark'"
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                            />
                        </svg>
                        <!-- Moon icon (shown in light mode - click to go dark) -->
                        <svg
                            x-show="currentMode === 'light'"
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                            />
                        </svg>
                    </button>

                    <!-- Theme Palette Selector -->
                    <div x-data="{ open: false }" class="relative">
                        <button
                            @click="open = !open"
                            class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-dark-700/50 border border-dark-600 hover:border-accent-blue transition"
                        >
                            <svg
                                class="w-4 h-4"
                                fill="none"
                                stroke="currentColor"
                                viewBox="0 0 24 24"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"
                                />
                            </svg>
                            <span class="hidden sm:inline">Theme</span>
                        </button>

                        <div
                            x-show="open"
                            @click.away="open = false"
                            x-transition:enter="transition ease-out duration-100"
                            x-transition:enter-start="opacity-0 scale-95"
                            x-transition:enter-end="opacity-100 scale-100"
                            x-transition:leave="transition ease-in duration-75"
                            x-transition:leave-start="opacity-100 scale-100"
                            x-transition:leave-end="opacity-0 scale-95"
                            class="absolute right-0 mt-2 w-40 rounded-lg bg-dark-800 border border-dark-600 shadow-xl overflow-hidden"
                        >
                            <!-- Tokyo -->
                            <button
                                @click="setPalette('tokyo'); open = false"
                                class="w-full px-4 py-2.5 hover:bg-dark-700 transition flex items-center gap-3"
                                :class="currentPalette === 'tokyo' ? 'text-accent-cyan' : ''"
                            >
                                <span
                                    class="w-3 h-3 rounded-full bg-[#7aa2f7]"
                                ></span>
                                <span class="flex-1 text-left">Tokyo</span>
                            </button>

                            <!-- Catppuccin -->
                            <button
                                @click="setPalette('catppuccin'); open = false"
                                class="w-full px-4 py-2.5 hover:bg-dark-700 transition flex items-center gap-3"
                                :class="currentPalette === 'catppuccin' ? 'text-accent-cyan' : ''"
                            >
                                <span
                                    class="w-3 h-3 rounded-full bg-[#cba6f7]"
                                ></span>
                                <span class="flex-1 text-left">Catppuccin</span>
                            </button>

                            <!-- Gruvbox -->
                            <button
                                @click="setPalette('gruvbox'); open = false"
                                class="w-full px-4 py-2.5 hover:bg-dark-700 transition flex items-center gap-3"
                                :class="currentPalette === 'gruvbox' ? 'text-accent-cyan' : ''"
                            >
                                <span
                                    class="w-3 h-3 rounded-full bg-[#fe8019]"
                                ></span>
                                <span class="flex-1 text-left">Gruvbox</span>
                                <span
                                    class="text-[#fabd2f] text-sm leading-none"
                                    style="font-family: system-ui"
                                    >&#9733;</span
                                >
                            </button>

                            <!-- Material -->
                            <button
                                @click="setPalette('material'); open = false"
                                class="w-full px-4 py-2.5 hover:bg-dark-700 transition flex items-center gap-3"
                                :class="currentPalette === 'material' ? 'text-accent-cyan' : ''"
                            >
                                <span
                                    class="w-3 h-3 rounded-full bg-[#82aaff]"
                                ></span>
                                <span class="flex-1 text-left">Material</span>
                            </button>

                            <!-- Nord -->
                            <button
                                @click="setPalette('nord'); open = false"
                                class="w-full px-4 py-2.5 hover:bg-dark-700 transition flex items-center gap-3"
                                :class="currentPalette === 'nord' ? 'text-accent-cyan' : ''"
                            >
                                <span
                                    class="w-3 h-3 rounded-full bg-[#88c0d0]"
                                ></span>
                                <span class="flex-1 text-left">Nord</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Compact floating nav (scrolled state) -->
    <div
        :class="scrolled ? 'translate-y-0' : '-translate-y-[calc(100%+2rem)]'"
        class="fixed top-4 left-1/2 -translate-x-1/2 transition-transform duration-500 ease-out"
    >
        <div
            class="flex items-center gap-1 px-2 py-2 rounded-full bg-dark-800/40 backdrop-blur-xl border border-white/10 shadow-2xl shadow-black/20"
        >
            <!-- Logo/Brand -->
            <a
                href="/#home"
                class="flex items-center gap-2 px-4 py-2 rounded-full hover:bg-white/5 transition-colors duration-200"
            >
                <span class="text-accent-green text-sm mono">&gt;_</span>
                <span
                    class="text-text-primary text-sm font-medium tracking-wide uppercase"
                    >Portfolio</span
                >
                <span class="text-text-muted text-sm">/</span>
                <span class="text-text-secondary text-sm font-medium">V2</span>
            </a>

            <!-- Divider -->
            <div class="w-px h-6 bg-white/10"></div>

            <!-- Navigation Links -->
            <div class="flex items-center">
                <a
                    href="/#projects"
                    class="px-4 py-2 text-sm text-text-muted hover:text-text-primary uppercase tracking-wider transition-colors duration-200"
                    >Projects</a
                >
                <a
                    href="/#stack"
                    class="px-4 py-2 text-sm text-text-muted hover:text-text-primary uppercase tracking-wider transition-colors duration-200"
                    >Stack</a
                >
                <a
                    href="/#process"
                    class="px-4 py-2 text-sm text-text-muted hover:text-text-primary uppercase tracking-wider transition-colors duration-200"
                    >Process</a
                >
                <a
                    href="/gallery"
                    class="px-4 py-2 text-sm text-text-muted hover:text-text-primary uppercase tracking-wider transition-colors duration-200"
                    >Gallery</a
                >
            </div>

            <!-- Divider -->
            <div class="w-px h-6 bg-white/10"></div>

            <!-- Theme Controls (Compact) -->
            <div class="flex items-center gap-1 px-2">
                <!-- Dark/Light Toggle -->
                <button
                    @click="toggleMode()"
                    class="p-2 rounded-full hover:bg-white/5 transition-colors duration-200"
                    :title="currentMode === 'dark' ? 'Switch to light mode' : 'Switch to dark mode'"
                >
                    <!-- Sun icon (shown in dark mode - click to go light) -->
                    <svg
                        x-show="currentMode === 'dark'"
                        class="w-4 h-4"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                        />
                    </svg>
                    <!-- Moon icon (shown in light mode - click to go dark) -->
                    <svg
                        x-show="currentMode === 'light'"
                        class="w-4 h-4"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                        />
                    </svg>
                </button>

                <!-- Theme Palette (Mini) -->
                <div x-data="{ open: false }" class="relative">
                    <button
                        @click="open = !open"
                        class="p-2 rounded-full hover:bg-white/5 transition-colors duration-200"
                        title="Change theme"
                    >
                        <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"
                            />
                        </svg>
                    </button>

                    <div
                        x-show="open"
                        @click.away="open = false"
                        x-transition:enter="transition ease-out duration-100"
                        x-transition:enter-start="opacity-0 scale-95"
                        x-transition:enter-end="opacity-100 scale-100"
                        x-transition:leave="transition ease-in duration-75"
                        x-transition:leave-start="opacity-100 scale-100"
                        x-transition:leave-end="opacity-0 scale-95"
                        class="absolute bottom-full mb-2 left-1/2 -translate-x-1/2 w-40 rounded-lg bg-dark-800/95 backdrop-blur-xl border border-white/10 shadow-xl overflow-hidden"
                    >
                        <button
                            @click="setPalette('tokyo'); open = false"
                            class="w-full px-4 py-2 hover:bg-white/5 transition flex items-center gap-3 text-sm"
                            :class="currentPalette === 'tokyo' ? 'text-accent-cyan' : ''"
                        >
                            <span
                                class="w-2.5 h-2.5 rounded-full bg-[#7aa2f7]"
                            ></span>
                            <span>Tokyo</span>
                        </button>
                        <button
                            @click="setPalette('catppuccin'); open = false"
                            class="w-full px-4 py-2 hover:bg-white/5 transition flex items-center gap-3 text-sm"
                            :class="currentPalette === 'catppuccin' ? 'text-accent-cyan' : ''"
                        >
                            <span
                                class="w-2.5 h-2.5 rounded-full bg-[#cba6f7]"
                            ></span>
                            <span>Catppuccin</span>
                        </button>
                        <button
                            @click="setPalette('gruvbox'); open = false"
                            class="w-full px-4 py-2 hover:bg-white/5 transition flex items-center gap-3 text-sm"
                            :class="currentPalette === 'gruvbox' ? 'text-accent-cyan' : ''"
                        >
                            <span
                                class="w-2.5 h-2.5 rounded-full bg-[#fe8019]"
                            ></span>
                            <span class="flex-1 text-left">Gruvbox</span>
                            <span
                                class="text-[#fabd2f] text-xs"
                                style="font-family: system-ui"
                                >&#9733;</span
                            >
                        </button>
                        <button
                            @click="setPalette('material'); open = false"
                            class="w-full px-4 py-2 hover:bg-white/5 transition flex items-center gap-3 text-sm"
                            :class="currentPalette === 'material' ? 'text-accent-cyan' : ''"
                        >
                            <span
                                class="w-2.5 h-2.5 rounded-full bg-[#82aaff]"
                            ></span>
                            <span>Material</span>
                        </button>
                        <button
                            @click="setPalette('nord'); open = false"
                            class="w-full px-4 py-2 hover:bg-white/5 transition flex items-center gap-3 text-sm"
                            :class="currentPalette === 'nord' ? 'text-accent-cyan' : ''"
                        >
                            <span
                                class="w-2.5 h-2.5 rounded-full bg-[#88c0d0]"
                            ></span>
                            <span>Nord</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Divider -->
            <div class="w-px h-6 bg-white/10"></div>

            <!-- Status Badge -->
            <a
                href="https://t.me/duma799"
                target="_blank"
                rel="noopener noreferrer"
                class="group flex items-center gap-2 px-4 py-2 transition-all duration-300"
            >
                <span
                    class="w-2 h-2 rounded-full bg-accent-green group-hover:bg-accent-blue animate-pulse transition-colors duration-300"
                ></span>
                <span
                    class="text-accent-green group-hover:text-accent-blue text-sm uppercase tracking-wider whitespace-nowrap transition-colors duration-300"
                    >Available for Hire</span
                >
                <!-- Telegram Icon -->
                <img
                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Telegram_2019_Logo.svg/500px-Telegram_2019_Logo.svg.png"
                    alt="Telegram"
                    class="w-0 h-4 group-hover:w-4 opacity-0 group-hover:opacity-100 transition-all duration-300"
                />
            </a>
        </div>
    </div>
</nav>
